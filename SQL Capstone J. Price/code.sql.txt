-- Question 1a: How many campaigns and sources does CoolTShirts use and how are they related? Be sure to explain the difference between utm_campaign and utm_source.SELECT COUNT (distinct utm_campaign)FROM page_visits;SELECT COUNT(distinct utm_source)FROM page_visits;SELECT distinct utm_campaign, utm_sourceFROM page_visits;-- Question 1b: What pages are on their website?SELECT distinct page_nameFROM page_visits;SELECT distinct page_name, COUNT (*) AS number_visitsFROM page_visitsGROUP BY 1;-- Question 2a: How many first touches is each campaign responsible for?WITH first_touch AS (    SELECT user_id,        MIN(timestamp) AS first_touch_at    FROM page_visits    GROUP BY user_id)SELECT pv.utm_campaign AS Campaign, COUNT( ft.first_touch_at) AS First_TouchesFROM first_touch ftJOIN page_visits pv    ON ft.user_id = pv.user_id    AND ft.first_touch_at = pv.timestamp    GROUP BY 1    ORDER BY 2 desc;-- Question 2.b: How many last touches is each campaign responsible for?WITH last_touch AS (    SELECT user_id,        MAX(timestamp) AS last_touch_at    FROM page_visits    GROUP BY user_id)SELECT pv.utm_campaign AS Campaign, COUNT( lt.last_touch_at) AS Last_TouchesFROM last_touch ltJOIN page_visits pv    ON lt.user_id = pv.user_id    AND lt.last_touch_at = pv.timestamp    GROUP BY 1    ORDER BY 2 desc;-- Question 2c: How many visitors make a purchase?SELECT page_name, COUNT (distinct user_id) AS visitor_countFROM page_visitsWHERE page_name = "4 - purchase";--Question 2d: How many last touches on the purchase page is each campaign responsible for?WITH last_touch AS (    SELECT user_id,        MAX(timestamp) AS last_touch_at    FROM page_visits  WHERE page_name = '4 - purchase'    GROUP BY user_id)SELECT pv.utm_campaign AS Campaign, COUNT(lt.last_touch_at) AS last_touchesFROM last_touch ltJOIN page_visits pv    ON lt.user_id = pv.user_id    AND lt.last_touch_at = pv.timestamp    GROUP BY 1    ORDER BY 2 desc;--Question 2e:  What is the typical user journey?SELECT COUNT (distinct user_id) as User_Visits, page_nameFROM page_visitsGROUP BY page_name;